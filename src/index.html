<!DOCTYPE html>
<html>
<body>

<!-- Load webassembly after the rest of the page has loaded--->
<script type="module">
import { zig } from "./mach-sysjs.js";

let env = {
  memory: new WebAssembly.Memory({
    initial: 17,
    maximum: 17,
    shared: true,
  }),
};

let imports = { zig, env };

WebAssembly
  .instantiateStreaming(fetch("/bin/webaudio-shared-memory.wasm"), imports)
  .then(({ module, instance }) => {
    zig.init(instance, env.memory);
    instance.exports._start();
  })
  .catch(err => console.error(err));
</script>
</body>

</html>
